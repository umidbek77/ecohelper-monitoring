<!DOCTYPE html>
<html lang="uz">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ECOHELPER | Statistika va Monitoring</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div class="main-container">
    <!-- Sidebar -->
    <nav class="sidebar">
      <div class="sidebar-header">
        <h4><i class="bi bi-graph-up-arrow"></i> ECOHELPER</h4>
        <small>Statistika & Monitoring</small>
      </div>
      <div class="sidebar-nav">
        <div class="nav-item">
          <a href="#" class="nav-link active" onclick="showSection('dashboard')">
            <i class="bi bi-speedometer2"></i> Bosh sahifa
          </a>
        </div>
        <div class="nav-item">
          <a href="#" class="nav-link" onclick="showSection('analytics')">
            <i class="bi bi-bar-chart-line"></i> Tahlil va diagrammalar
          </a>
        </div>
        <div class="nav-item">
          <a href="#" class="nav-link" onclick="showSection('monitoring')">
            <i class="bi bi-activity"></i> Real vaqt monitoring
          </a>
        </div>
        <div class="nav-item">
          <a href="#" class="nav-link" onclick="showSection('environmental')">
            <i class="bi bi-globe"></i> Ekologik ko'rsatkichlar
          </a>
        </div>
        <div class="nav-item">
          <a href="#" class="nav-link" onclick="showSection('leaderboard')">
            <i class="bi bi-trophy"></i> Reyting va faollik
          </a>
        </div>
        <div class="nav-item">
          <a href="#" class="nav-link" onclick="showSection('zones')">
            <i class="bi bi-geo-alt"></i> Hudud tahlili
          </a>
        </div>
        <div class="nav-item">
          <a href="#" class="nav-link" onclick="showSection('reports')">
            <i class="bi bi-file-earmark-pdf"></i> Hisobotlar
          </a>
        </div>
      </div>
    </nav>

    <!-- Content -->
    <main class="content">
      <!-- Dashboard Section -->
      <div id="dashboard" class="section active">
        <div class="page-header">
          <h2><i class="bi bi-speedometer2"></i> Bosh sahifa</h2>
          <div class="real-time-status" title="Real vaqt rejimi faol"></div>
        </div>
        
        <div class="stats-grid">
          <div class="stat-card primary">
            <div class="stat-header">
              <div>
                <div class="stat-number" id="totalReports">1,247</div>
                <div class="stat-label">Jami xabarlar</div>
                <div class="stat-change positive">
                  <i class="bi bi-arrow-up"></i> +12.5% bu oy
                </div>
              </div>
              <div class="stat-icon primary">
                <i class="bi bi-inbox"></i>
              </div>
            </div>
          </div>

          <div class="stat-card success">
            <div class="stat-header">
              <div>
                <div class="stat-number" id="resolvedIssues">983</div>
                <div class="stat-label">Hal qilingan</div>
                <div class="stat-change positive">
                  <i class="bi bi-arrow-up"></i> +18.2% bu oy
                </div>
              </div>
              <div class="stat-icon success">
                <i class="bi bi-check-circle"></i>
              </div>
            </div>
          </div>

          <div class="stat-card info">
            <div class="stat-header">
              <div>
                <div class="stat-number" id="activeUsers">2,834</div>
                <div class="stat-label">Faol foydalanuvchilar</div>
                <div class="stat-change positive">
                  <i class="bi bi-arrow-up"></i> +7.8% bu oy
                </div>
              </div>
              <div class="stat-icon info">
                <i class="bi bi-people"></i>
              </div>
            </div>
          </div>

          <div class="stat-card warning">
            <div class="stat-header">
              <div>
                <div class="stat-number" id="responseTime">2.4</div>
                <div class="stat-label">O'rtacha javob vaqti (soat)</div>
                <div class="stat-change negative">
                  <i class="bi bi-arrow-down"></i> -15.3% bu oy
                </div>
              </div>
              <div class="stat-icon warning">
                <i class="bi bi-clock"></i>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-8">
            <div class="chart-container">
              <div class="chart-header">
                <h4><i class="bi bi-graph-up"></i> Haftalik faollik</h4>
                <button class="btn btn-sm btn-primary" onclick="refreshChart('weeklyActivity')">
                  <i class="bi bi-arrow-clockwise"></i> Yangilash
                </button>
              </div>
              <canvas id="weeklyActivityChart" height="300"></canvas>
            </div>
          </div>
          
          <div class="col-lg-4">
            <div class="chart-container">
              <div class="chart-header">
                <h4><i class="bi bi-pie-chart"></i> Muammo turlari</h4>
              </div>
              <canvas id="issueTypesChart" height="300"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Analytics Section -->
      <div id="analytics" class="section">
        <div class="page-header">
          <h2><i class="bi bi-bar-chart-line"></i> Tahlil va diagrammalar</h2>
        </div>
        
        <div class="row">
          <div class="col-lg-6">
            <div class="chart-container">
              <div class="chart-header">
                <h4><i class="bi bi-geo-alt"></i> Hududlar bo'yicha statistika</h4>
              </div>
              <canvas id="regionChart" height="400"></canvas>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="chart-container">
              <div class="chart-header">
                <h4><i class="bi bi-calendar-month"></i> Oylik o'zgarishlar</h4>
              </div>
              <canvas id="monthlyTrendChart" height="400"></canvas>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <div class="chart-header">
            <h4><i class="bi bi-speedometer"></i> Brigada samaradorligi</h4>
          </div>
          <canvas id="brigadeEfficiencyChart" height="300"></canvas>
        </div>
      </div>

      <!-- Monitoring Section -->
      <div id="monitoring" class="section">
        <div class="page-header">
          <h2><i class="bi bi-activity"></i> Real vaqt monitoring</h2>
        </div>
        
        <div class="zone-indicators">
          <div class="zone-indicator green">
            <h5><i class="bi bi-shield-check"></i> Yashil zona</h5>
            <div class="stat-number text-success">15</div>
            <small>Eng yaxshi xizmat</small>
          </div>
          <div class="zone-indicator red">
            <h5><i class="bi bi-exclamation-triangle"></i> Qizil zona</h5>
            <div class="stat-number text-danger">3</div>
            <small>Diqqat talab etadi</small>
          </div>
        </div>

        <div class="chart-container">
          <div class="chart-header">
            <h4><i class="bi bi-geo-alt"></i> Real vaqt xarita</h4>
            <div>
              <button class="btn btn-sm btn-success me-2" onclick="updateMapData()">
                <i class="bi bi-arrow-clockwise"></i> Yangilash
              </button>
              <button class="btn btn-sm btn-info" onclick="toggleHeatmap()">
                <i class="bi bi-thermometer-half"></i> Issiqlik xaritasi
              </button>
            </div>
          </div>
          <div id="realTimeMap"></div>
        </div>
      </div>

      <!-- Environmental Section -->
      <div id="environmental" class="section">
        <div class="page-header">
          <h2><i class="bi bi-globe"></i> Ekologik ko'rsatkichlar</h2>
        </div>
        
        <div class="environmental-grid">
          <div class="env-card">
            <div class="env-header">
              <div class="env-icon" style="background: var(--gradient-warning);">
                <i class="bi bi-cloud"></i>
              </div>
              <div>
                <h5>Issiqxona gazlari</h5>
                <div class="stat-number text-warning">342</div>
                <small>CO2 ppm</small>
              </div>
            </div>
            <div class="gauge">
              <div class="gauge-fill" style="width: 68%; background: var(--gradient-warning);"></div>
            </div>
          </div>

          <div class="env-card">
            <div class="env-header">
              <div class="env-icon" style="background: var(--gradient-info);">
                <i class="bi bi-droplet"></i>
              </div>
              <div>
                <h5>Suv sarfi</h5>
                <div class="stat-number text-info">1,240</div>
                <small>Litr/kun</small>
              </div>
            </div>
            <div class="gauge">
              <div class="gauge-fill" style="width: 45%; background: var(--gradient-info);"></div>
            </div>
          </div>

          <div class="env-card">
            <div class="env-header">
              <div class="env-icon" style="background: var(--gradient-success);">
                <i class="bi bi-recycle"></i>
              </div>
              <div>
                <h5>Chiqindi miqdori</h5>
                <div class="stat-number text-success">89</div>
                <small>Tonna/oy</small>
              </div>
            </div>
            <div class="gauge">
              <div class="gauge-fill" style="width: 75%; background: var(--gradient-success);"></div>
            </div>
          </div>

          <div class="env-card">
            <div class="env-header">
              <div class="env-icon" style="background: var(--gradient-primary);">
                <i class="bi bi-lightning"></i>
              </div>
              <div>
                <h5>Energiya sarfi</h5>
                <div class="stat-number text-primary">567</div>
                <small>kWh/kun</small>
              </div>
            </div>
            <div class="gauge">
              <div class="gauge-fill" style="width: 82%; background: var(--gradient-primary);"></div>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <div class="chart-header">
            <h4><i class="bi bi-graph-up"></i> Ekologik tendentsiyalar</h4>
          </div>
          <canvas id="environmentalTrendChart" height="300"></canvas>
        </div>
      </div>

      <!-- Leaderboard Section -->
      <div id="leaderboard" class="section">
        <div class="page-header">
          <h2><i class="bi bi-trophy"></i> Reyting va faollik</h2>
        </div>

        <div class="row">
          <div class="col-lg-6">
            <div class="top-performers">
              <div class="chart-header">
                <h4><i class="bi bi-star-fill"></i> Eng faol foydalanuvchilar</h4>
              </div>
              
              <div class="performer-item">
                <div class="performer-avatar">AM</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">Akmal Mahmudov</h6>
                  <small class="text-muted">124 xabar yuborgan</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 95%"></div>
                  </div>
                </div>
                <div class="rank-badge gold">1</div>
              </div>

              <div class="performer-item">
                <div class="performer-avatar" style="background: var(--gradient-success);">DN</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">Dilnoza Normurodova</h6>
                  <small class="text-muted">89 xabar yuborgan</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 72%"></div>
                  </div>
                </div>
                <div class="rank-badge silver">2</div>
              </div>

              <div class="performer-item">
                <div class="performer-avatar" style="background: var(--gradient-warning);">SA</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">Sardor Aliyev</h6>
                  <small class="text-muted">76 xabar yuborgan</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 61%"></div>
                  </div>
                </div>
                <div class="rank-badge bronze">3</div>
              </div>

              <div class="performer-item">
                <div class="performer-avatar" style="background: var(--gradient-info);">ZK</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">Zilola Karimova</h6>
                  <small class="text-muted">65 xabar yuborgan</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 52%"></div>
                  </div>
                </div>
                <div class="rank-badge">4</div>
              </div>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="top-performers">
              <div class="chart-header">
                <h4><i class="bi bi-tools"></i> Eng samarali brigadalar</h4>
              </div>
              
              <div class="performer-item">
                <div class="performer-avatar">B1</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">1-Brigada (Chilonzor)</h6>
                  <small class="text-muted">98% hal qilish ko'rsatkichi</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 98%"></div>
                  </div>
                </div>
                <div class="rank-badge gold">1</div>
              </div>

              <div class="performer-item">
                <div class="performer-avatar" style="background: var(--gradient-success);">B5</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">5-Brigada (Yunusobod)</h6>
                  <small class="text-muted">94% hal qilish ko'rsatkichi</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 94%"></div>
                  </div>
                </div>
                <div class="rank-badge silver">2</div>
              </div>

              <div class="performer-item">
                <div class="performer-avatar" style="background: var(--gradient-warning);">B3</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">3-Brigada (Mirobod)</h6>
                  <small class="text-muted">91% hal qilish ko'rsatkichi</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 91%"></div>
                  </div>
                </div>
                <div class="rank-badge bronze">3</div>
              </div>

              <div class="performer-item">
                <div class="performer-avatar" style="background: var(--gradient-info);">B7</div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">7-Brigada (Yakkasaroy)</h6>
                  <small class="text-muted">88% hal qilish ko'rsatkichi</small>
                  <div class="progress-bar-modern">
                    <div class="progress-bar-fill" style="width: 88%"></div>
                  </div>
                </div>
                <div class="rank-badge">4</div>
              </div>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <div class="chart-header">
            <h4><i class="bi bi-activity"></i> Haftalik faollik reytingi</h4>
          </div>
          <canvas id="weeklyRankingChart" height="300"></canvas>
        </div>
      </div>

      <!-- Zones Section -->
      <div id="zones" class="section">
        <div class="page-header">
          <h2><i class="bi bi-geo-alt"></i> Hudud tahlili</h2>
        </div>

        <div class="zone-analysis">
          <div class="chart-header">
            <h4><i class="bi bi-map"></i> Hududlar bo'yicha baholash</h4>
          </div>

          <div class="zone-item excellent">
            <div>
              <h5><i class="bi bi-geo-alt-fill me-2"></i>Chilonzor tumani</h5>
              <small>A'lo darajadagi xizmat ko'rsatish</small>
            </div>
            <div class="text-end">
              <div class="metric-value text-success">A+</div>
              <small class="text-success">98.5% samaradorlik</small>
            </div>
          </div>

          <div class="zone-item good">
            <div>
              <h5><i class="bi bi-geo-alt-fill me-2"></i>Yunusobod tumani</h5>
              <small>Yaxshi xizmat ko'rsatish</small>
            </div>
            <div class="text-end">
              <div class="metric-value text-info">A</div>
              <small class="text-info">94.2% samaradorlik</small>
            </div>
          </div>

          <div class="zone-item good">
            <div>
              <h5><i class="bi bi-geo-alt-fill me-2"></i>Mirobod tumani</h5>
              <small>Yaxshi xizmat ko'rsatish</small>
            </div>
            <div class="text-end">
              <div class="metric-value text-info">B+</div>
              <small class="text-info">91.7% samaradorlik</small>
            </div>
          </div>

          <div class="zone-item warning">
            <div>
              <h5><i class="bi bi-geo-alt-fill me-2"></i>Yakkasaroy tumani</h5>
              <small>Yaxshilash talab etiladi</small>
            </div>
            <div class="text-end">
              <div class="metric-value text-warning">B</div>
              <small class="text-warning">85.3% samaradorlik</small>
            </div>
          </div>

          <div class="zone-item danger">
            <div>
              <h5><i class="bi bi-geo-alt-fill me-2"></i>Sergeli tumani</h5>
              <small>Qoniqarsiz xizmat ko'rsatish</small>
            </div>
            <div class="text-end">
              <div class="metric-value text-danger">C</div>
              <small class="text-danger">72.1% samaradorlik</small>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-8">
            <div class="chart-container">
              <div class="chart-header">
                <h4><i class="bi bi-bar-chart"></i> Hududlar bo'yicha taqqoslash</h4>
              </div>
              <canvas id="zonesComparisonChart" height="400"></canvas>
            </div>
          </div>
          
          <div class="col-lg-4">
            <div class="environmental-grid">
              <div class="metric-card">
                <div class="metric-value">18</div>
                <div class="metric-label">Jami hududlar</div>
                <div class="trend-indicator trend-up">
                  <i class="bi bi-arrow-up me-1"></i>+2 yangi
                </div>
              </div>
              
              <div class="metric-card">
                <div class="metric-value">15</div>
                <div class="metric-label">Yashil zonalar</div>
                <div class="trend-indicator trend-up">
                  <i class="bi bi-arrow-up me-1"></i>+3 yaxshilangan
                </div>
              </div>
              
              <div class="metric-card">
                <div class="metric-value">3</div>
                <div class="metric-label">Qizil zonalar</div>
                <div class="trend-indicator trend-down">
                  <i class="bi bi-arrow-down me-1"></i>-2 kamaygan
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Reports Section -->
      <div id="reports" class="section">
        <div class="page-header">
          <h2><i class="bi bi-file-earmark-pdf"></i> Hisobotlar</h2>
        </div>

        <div class="row mb-4">
          <div class="col-lg-6">
            <div class="alert-modern alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Avtomatik hisobotlar:</strong> Har kuni, hafta va oyda avtomatik ravishda hisobotlar yaratiladi va tegishli tashkilotlarga yuboriladi.
            </div>
          </div>
          <div class="col-lg-6">
            <div class="d-flex gap-2">
              <button class="btn btn-primary" onclick="generateReport('daily')">
                <i class="bi bi-calendar-day"></i> Kunlik hisobot
              </button>
              <button class="btn btn-success" onclick="generateReport('weekly')">
                <i class="bi bi-calendar-week"></i> Haftalik hisobot
              </button>
              <button class="btn btn-info" onclick="generateReport('monthly')">
                <i class="bi bi-calendar-month"></i> Oylik hisobot
              </button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-8">
            <div class="chart-container">
              <div class="chart-header">
                <h4><i class="bi bi-file-text"></i> So'nggi hisobotlar</h4>
              </div>
              
              <div class="report-item">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <div class="stat-icon success me-3">
                      <i class="bi bi-file-earmark-check"></i>
                    </div>
                    <div>
                      <h6 class="mb-1">Oylik hisobot - Noyabr 2024</h6>
                      <small class="text-muted">Yaratilgan: 01.12.2024, 09:30</small>
                    </div>
                  </div>
                  <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-primary">
                      <i class="bi bi-eye"></i> Ko'rish
                    </button>
                    <button class="btn btn-sm btn-primary">
                      <i class="bi bi-download"></i> Yuklab olish
                    </button>
                  </div>
                </div>
              </div>

              <div class="report-item">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <div class="stat-icon info me-3">
                      <i class="bi bi-file-earmark-bar-graph"></i>
                    </div>
                    <div>
                      <h6 class="mb-1">Haftalik tahlil - 47-hafta</h6>
                      <small class="text-muted">Yaratilgan: 25.11.2024, 08:00</small>
                    </div>
                  </div>
                  <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-primary">
                      <i class="bi bi-eye"></i> Ko'rish
                    </button>
                    <button class="btn btn-sm btn-primary">
                      <i class="bi bi-download"></i> Yuklab olish
                    </button>
                  </div>
                </div>
              </div>

              <div class="report-item">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <div class="stat-icon warning me-3">
                      <i class="bi bi-file-earmark-excel"></i>
                    </div>
                    <div>
                      <h6 class="mb-1">Ekologik ko'rsatkichlar - Q3 2024</h6>
                      <small class="text-muted">Yaratilgan: 15.11.2024, 14:45</small>
                    </div>
                  </div>
                  <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-primary">
                      <i class="bi bi-eye"></i> Ko'rish
                    </button>
                    <button class="btn btn-sm btn-primary">
                      <i class="bi bi-download"></i> Yuklab olish
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="environmental-grid">
              <div class="metric-card">
                <div class="metric-value">248</div>
                <div class="metric-label">Jami hisobotlar</div>
                <div class="trend-indicator trend-up">
                  <i class="bi bi-arrow-up me-1"></i>Bu oy +12
                </div>
              </div>
              
              <div class="metric-card">
                <div class="metric-value">156</div>
                <div class="metric-label">PDF formatida</div>
                <div class="trend-indicator trend-up">
                  <i class="bi bi-file-pdf me-1"></i>63%
                </div>
              </div>
              
              <div class="metric-card">
                <div class="metric-value">92</div>
                <div class="metric-label">Excel formatida</div>
                <div class="trend-indicator trend-up">
                  <i class="bi bi-file-excel me-1"></i>37%
                </div>
              </div>
            </div>

            <div class="chart-container">
              <div class="chart-header">
                <h4><i class="bi bi-pie-chart"></i> Hisobot turlari</h4>
              </div>
              <canvas id="reportTypesChart" height="250"></canvas>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  <!-- Footer qismi -->
  <footer class="text-center py-3" style="background-color: var(--secondary-color); color: white;">
    <div class="container">
      <p class="mb-0">© 2024 ECOHELPER Monitoring Tizimi | Barcha huquqlar himoyalangan</p>
      <p class="mb-0 small">Ishlab chiquvchilar: ECOHELPER Dasturchilar Jamoasi</p>
      <p class="small">Versiya: 1.0.0 | Yangilanish sanasi: 15.12.2024</p>
    </div>
  </footer>
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- Qo'shimcha JavaScript kutubxonalari -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js-plugin-datalabels@2.0.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
  <script src="./app.js"></script>
</body>
</html>
